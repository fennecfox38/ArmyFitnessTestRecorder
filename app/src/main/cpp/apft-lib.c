#include <jni.h>
#include <math.h>

static int PUM0[78]={0,3,5,6,8,9,10,12,13,14,16,17,19,20,21,23,24,26,27,28,30,31,32,34,35,37,38,39,41,42,43,45,46,48,49,50,52,53,54,56,57,59,60,61,63,64,66,67,68,70,71,72,74,75,77,78,79,81,82,83,85,86,88,89,90,92,93,94,96,97,99,100,100,100,100,100,100,100};
static int PUM1[78]={0,15,17,18,19,20,21,22,23,25,26,27,28,29,30,31,33,34,35,36,37,38,39,41,42,43,44,45,46,47,49,50,51,52,53,54,55,57,58,59,60,61,62,63,65,66,67,68,69,70,71,73,74,75,76,77,78,79,81,82,83,84,85,86,87,89,90,91,92,93,94,95,97,98,99,100,100,100};
static int PUM2[78]={0,20,21,22,23,24,25,26,27,28,29,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,92,93,94,95,96,97,98,99,100};
static int PUM3[78]={0,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,100,100};
static int PUM4[78]={0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,100,100,100,100};
static int PUM5[78]={0,0,0,0,0,32,33,34,36,37,38,39,40,41,42,43,44,46,47,48,49,50,51,52,53,54,56,57,58,59,60,61,62,63,64,66,67,68,69,70,71,72,73,74,76,77,78,79,80,81,82,83,84,86,87,88,89,90,91,92,93,94,96,97,98,99,100,100,100,100,100,100,100,100,100,100,100,100};
static int PUM6[78]={0,0,0,0,0,36,38,39,40,41,42,45,46,47,48,49,50,51,52,53,54,55,56,58,59,60,61,62,64,65,66,67,68,69,71,72,73,74,75,76,78,79,80,81,82,85,86,87,88,89,90,91,92,93,94,95,96,98,99,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100};
static int PUM7[78]={0,0,0,0,0,43,44,46,47,48,49,50,51,52,53,54,56,57,58,59,60,61,62,63,64,66,67,68,69,70,71,72,73,74,76,77,78,79,80,81,82,83,84,86,87,88,89,90,91,92,94,95,96,97,98,99,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100};

static int PUF0[51]={0,29,30,32,34,36,37,39,41,43,44,46,58,50,51,53,55,57,58,60,62,63,65,67,69,70,72,74,76,77,79,81,83,84,86,88,90,91,93,95,97,98,100,100,100,100,100,100,100,100,100};
static int PUF1[51]={0,38,39,41,42,43,45,45,48,49,49,50,52,54,56,57,59,60,61,63,64,66,67,68,70,71,72,74,75,77,78,79,81,82,83,85,86,88,89,90,92,93,94,96,97,99,100,100,100,100,100};
static int PUF2[51]={0,41,42,43,44,45,47,48,49,49,50,52,54,55,56,58,59,60,61,62,64,65,66,67,68,70,71,72,73,75,76,77,78,79,81,82,83,84,85,87,88,89,90,92,93,94,95,96,98,99,100};
static int PUF3[51]={0,41,43,44,45,47,48,49,49,50,52,54,58,58,59,60,61,63,64,65,67,68,69,71,72,73,75,76,77,79,80,81,83,84,85,87,88,89,91,92,93,95,96,100,100,100,100,100,100,100,100};
static int PUF4[51]={0,42,44,45,47,48,50,51,53,54,56,57,59,60,61,63,64,66,67,69,70,72,73,75,76,78,79,81,82,84,85,87,88,90,91,93,94,96,97,99,100,100,100,100,100,100,100,100,100,100,100};
static int PUF5[51]={0,0,0,0,0,49,50,52,54,55,57,58,50,62,63,65,66,68,70,71,73,64,76,78,79,81,82,84,86,87,89,90,92,94,95,97,98,100,100,100,100,100,100,100,100,100,100,100,100,100,100};
static int PUF6[51]={0,0,0,0,0,52,53,55,57,58,60,62,63,65,67,68,70,72,73,75,77,78,80,82,83,85,87,88,90,92,93,95,97,98,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100};
static int PUF7[51]={0,0,0,0,0,53,55,56,58,60,62,64,65,67,69,71,73,75,76,78,80,82,84,85,87,89,91,93,95,96,89,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100};

static int* PU[2][8]={{PUM0,PUM1,PUM2,PUM3,PUM4,PUM5,PUM6,PUM7},{PUF0,PUF1,PUF2,PUF3,PUF4,PUF5,PUF6,PUF7}};


static int SU[][62]={
        {9,10,12,14,15,17,18,20,22,23,25,26,28,30,31,33,34,36,38,39,41,42,44,45,47,49,50,52,54,55,57,58,60,62,63,65,66,68,70,71,73,74,76,78,79,81,82,84,87,88,89,90,92,94,95,97,98,100,100,100,100,100},
        {21,23,24,25,27,28,29,31,32,33,35,36,37,39,40,41,43,44,45,47,48,49,50,52,53,55,56,57,59,60,61,63,64,65,67,68,69,71,72,73,75,76,77,79,80,81,83,84,85,87,88,89,91,92,93,95,96,97,99,100,100,100},
        {34,35,36,37,38,39,41,42,43,44,45,46,47,48,49,50,51,52,54,55,56,57,58,59,60,61,62,63,64,65,66,68,69,70,71,72,73,74,75,76,77,78,79,81,82,83,84,85,86,87,88,89,90,91,92,94,95,96,97,98,99,100},
        {35,36,38,39,40,41,42,44,45,46,47,48,49,50,52,53,54,55,56,58,59,60,61,62,64,65,66,67,68,69,71,72,73,74,75,76,78,79,80,81,82,84,85,86,87,88,89,91,92,93,94,95,96,98,99,100,100,100,100,100,100,100},
        {42,43,44,45,46,47,48,49,50,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,92,93,94,95,96,97,98,99,100,100,100,100,100,100,100},
        {49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,100,100,100,100,100,100,100,100,100,100},
        {50,51,52,53,54,56,57,58,59,60,61,62,63,64,66,67,68,69,70,71,72,73,74,76,77,78,79,80,81,82,83,84,86,87,88,89,90,91,92,93,94,96,97,98,99,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100},
        {53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,92,93,94,95,96,97,98,99,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100}
};

static int RUNM[][78]={
        {0,0,0,0,0,1,2,3,5,6,8,9,10,12,13,14,17,18,19,20,21,23,24,26,27,28,30,31,32,34,35,37,38,39,41,42,43,45,46,48,49,50,52,53,54,56,57,59,60,61,63,64,66,67,68,70,71,72,74,75,77,78,79,81,82,83,85,86,88,89,90,92,93,94,96,97,99,100},
        {14,16,17,18,19,20,21,22,23,24,26,27,28,29,30,31,32,33,34,36,37,38,39,40,41,42,43,44,46,47,48,49,50,51,52,53,54,56,57,58,59,60,61,62,63,64,66,67,68,69,70,71,72,73,74,76,77,78,79,80,81,82,83,84,86,87,88,89,90,91,92,93,94,96,97,98,99,100},
        {19,20,21,22,23,24,25,28,29,30,31,32,33,34,35,36,37,38,39,41,42,43,44,45,46,47,48,49,50,51,52,54,55,56,57,58,59,60,61,62,63,64,65,66,68,69,70,71,72,73,74,75,76,77,78,79,81,82,83,84,85,86,87,88,89,90,91,92,94,95,96,97,98,99,100,100,100,100},
        {33,34,35,35,36,37,38,39,40,41,42,43,44,45,45,46,47,48,49,50,51,52,53,54,55,55,56,57,58,59,60,61,62,63,64,65,65,66,67,68,69,70,71,72,73,74,75,75,76,77,78,79,80,81,82,83,84,85,85,86,87,88,89,90,91,92,93,94,95,95,96,97,98,99,100,100,100,100},
        {40,40,41,42,43,44,45,46,46,47,48,49,50,51,51,52,53,54,55,56,57,57,58,59,60,61,62,63,63,64,65,66,67,68,69,69,70,71,72,73,74,74,75,76,77,78,79,80,80,81,82,83,84,85,86,86,87,88,89,90,91,91,92,93,94,95,96,97,97,98,99,100,100,100,100,100,100,100},
        {43,43,44,45,46,47,48,49,50,50,51,52,53,54,55,56,57,57,58,59,60,61,62,63,63,64,65,66,67,68,69,70,70,71,72,73,74,75,76,77,77,78,79,80,81,82,83,83,84,85,86,87,88,89,89,90,91,92,93,94,95,96,97,97,98,99,100,100,100,100,100,100,100,100,100,100,100,100},
        {51,51,52,53,54,55,55,56,57,58,58,59,60,61,62,62,63,64,65,65,66,67,68,69,69,70,71,72,73,73,74,75,76,76,77,78,79,80,80,81,82,83,84,84,85,86,87,87,88,89,90,91,91,92,93,94,95,95,96,97,98,98,99,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100},
        {53,54,55,55,56,57,58,58,59,60,61,62,62,63,64,65,65,66,67,68,69,69,70,71,72,73,73,74,75,76,76,77,78,79,80,80,81,82,83,84,84,85,86,87,87,88,89,90,91,91,92,93,94,95,95,96,97,98,98,99,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100}
};

static int RUNF[][52]={
        {38,39,41,42,43,44,45,47,48,49,50,52,53,54,55,56,58,59,60,61,62,64,65,66,67,68,70,71,72,73,75,76,77,78,79,81,82,83,84,85,87,88,89,90,92,93,94,95,96,98,99,100},
        {49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100},
        {58,59,60,61,62,63,63,64,65,66,67,68,69,69,70,71,72,73,74,74,75,76,77,78,79,80,80,81,82,83,84,85,86,86,87,88,89,90,91,91,92,93,94,95,96,97,97,98,99,100,100,100},
        {67,68,68,69,70,70,71,72,72,73,74,74,75,76,77,77,78,79,79,80,81,81,82,83,83,84,85,86,86,87,88,88,89,90,90,91,92,92,93,94,94,95,96,97,97,98,99,99,100,100,100,100},
        {74,75,75,76,77,78,78,79,80,80,81,82,82,83,84,85,85,86,87,87,88,89,89,90,91,92,92,93,94,94,95,96,96,97,98,99,99,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100},
        {79,80,80,81,82,82,83,83,84,85,85,86,87,87,88,89,89,90,90,91,92,92,93,94,94,95,96,96,97,97,98,99,99,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100},
        {81,81,82,82,83,84,84,85,86,86,87,87,88,89,89,90,91,91,92,92,93,94,94,95,96,96,97,97,98,99,99,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100},
        {87,88,89,90,90,91,92,93,93,94,95,96,96,97,98,99,99,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100}
};

static int WALK[2][8]={{2040,2070,2100,2130,2160,2190,2220,2250},{2220,2250,2280,2310,2340,2370,2400,2430}};
static int BIKE[2][8]={{1440,1470,1500,1530,1560,1620,1680,1800},{1500,1530,1560,1590,1620,1680,1800,1920}};
static int SWIM[2][8]={{1200,1230,1260,1290,1320,1350,1380,1440},{1260,1290,1320,1350,1380,1410,1440,1500}};

JNIEXPORT jint JNICALL Java_mil_army_fitnesstest_Standard_00024APFT_PUScore(JNIEnv *env, jclass clazz, jint sex, jint ageGroup, jint raw) {
    if((sex==0&&raw>77)||(sex==1&&raw>50)) return 100;
    else return PU[sex][ageGroup][raw];
}
JNIEXPORT jint JNICALL Java_mil_army_fitnesstest_Standard_00024APFT_SUScore(JNIEnv *env, jclass clazz, jint ageGroup, jint raw) {
    if(raw<21) return 0;
    else if(raw>82) return 100;
    else return SU[ageGroup][raw-21];
}

JNIEXPORT jint JNICALL Java_mil_army_fitnesstest_Standard_00024APFT_RUNScore(JNIEnv *env, jclass clazz, jint sex, jint ageGroup, jint sec) {
    if(sex==0){
        if(sec<780) return 100;
        else if(sec>1242) return 0;
        else return RUNM[ageGroup][(1242-sec)/6];
    }
    else{
        if(sec<936) return 100;
        else if(sec>1242) return 0;
        else return RUNF[ageGroup][(1242-sec)/6];
    }
}

JNIEXPORT jint JNICALL Java_mil_army_fitnesstest_Standard_00024APFT_WALKScore(JNIEnv *env, jclass clazz, jint sex, jint ageGroup, jint sec) {
    return (sec<=WALK[sex][ageGroup] ? 60 : 0);
}

JNIEXPORT jint JNICALL Java_mil_army_fitnesstest_Standard_00024APFT_BIKEScore(JNIEnv *env, jclass clazz, jint sex, jint ageGroup, jint sec) {
    return (sec<=BIKE[sex][ageGroup] ? 60 : 0);
}

JNIEXPORT jint JNICALL Java_mil_army_fitnesstest_Standard_00024APFT_SWIMScore(JNIEnv *env, jclass clazz, jint sex, jint ageGroup, jint sec) {
    return (sec<=SWIM[sex][ageGroup] ? 60 : 0);
}